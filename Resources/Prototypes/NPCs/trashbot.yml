- type: htnCompound
  id: TrashbotCompound
  branches:
  - tasks:
    - !type:HTNCompoundTask
      task: CollectNearbyTrashCompound
  - tasks:
    - !type:HTNCompoundTask
      task: IdleCompound

- type: htnCompound
  id: CollectNearbyTrashCompound
  branches:
  - preconditions:
    - !type:StorageCapacityPrecondition
      checkFull: false
    tasks:
    - !type:HTNPrimitiveTask
      operator: !type:UtilityOperator
        proto: NearbyTrash

    - !type:HTNPrimitiveTask
      operator: !type:MoveToOperator
        pathfindInPlanning: true
        removeKeyOnFinish: false
        targetKey: TargetCoordinates
        pathfindKey: TargetPathfind
        rangeKey: MeleeRange

    - !type:HTNPrimitiveTask
      preconditions:
      - !type:TargetInRangePrecondition
        targetKey: Target
        rangeKey: MeleeRange
      operator: !type:InteractWithOperator
        targetKey: Target

  - preconditions:
    - !type:StorageCapacityPrecondition
      checkFull: true
    tasks:
    - !type:HTNPrimitiveTask
      operator: !type:UtilityOperator
        proto: NearbyDisposalUnit
        key: DisposalUnit

    - !type:HTNPrimitiveTask
      operator: !type:MoveToOperator
        pathfindInPlanning: true
        removeKeyOnFinish: false
        targetKey: TargetCoordinates
        pathfindKey: TargetPathfind
        rangeKey: InteractRange

    - !type:HTNPrimitiveTask
      preconditions:
      - !type:TargetInRangePrecondition
        targetKey: DisposalUnit
        rangeKey: MeleeRange
      operator: !type:TrashbotDisposeOperator
        targetKey: DisposalUnit

  - preconditions:
    - !type:StorageCapacityPrecondition
      checkHasItems: true
    tasks:
    - !type:HTNPrimitiveTask
      operator: !type:UtilityOperator
        proto: NearbyDisposalUnit
        key: DisposalUnit

    - !type:HTNPrimitiveTask
      operator: !type:MoveToOperator
        pathfindInPlanning: true
        removeKeyOnFinish: false
        targetKey: TargetCoordinates
        pathfindKey: TargetPathfind
        rangeKey: InteractRange

    - !type:HTNPrimitiveTask
      preconditions:
      - !type:TargetInRangePrecondition
        targetKey: DisposalUnit
        rangeKey: MeleeRange
      operator: !type:TrashbotDisposeOperator
        targetKey: DisposalUnit
